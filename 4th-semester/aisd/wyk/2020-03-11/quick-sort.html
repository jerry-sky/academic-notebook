<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="pl" xml:lang="pl">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Jerry Sky" />
  <meta name="dcterms.date" content="2020-03-11" />
  <title>Quick Sort</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <link rel="stylesheet" href="/style.css" />
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" type="text/javascript"></script>
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Merriweather&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@500&display=swap" rel="stylesheet">
</head>
<body>
<header id="title-block-header">
<h1 class="title">Quick Sort</h1>
<p class="author">
    <span>by </span>
    <span class="author">Jerry Sky</span>
</p>
<p class="date">2020-03-11</p>
</header>
<hr />
<ul>
<li><a href="#the-quicksort-sorting-algorithm">The QuickSort sorting algorithm</a>
<ul>
<li><a href="#pseudocode-quicksort">Pseudocode <code>QuickSort</code></a></li>
<li><a href="#pseudocode-partition">Pseudocode <code>partition</code></a></li>
</ul></li>
<li><a href="#resolving-the-asymptotic-of-quicksort">Resolving the asymptotic of <code>QuickSort</code></a></li>
</ul>
<hr />
<h2 id="the-quicksort-sorting-algorithm">The QuickSort sorting algorithm</h2>
<h3 id="pseudocode-quicksort">Pseudocode <code>QuickSort</code></h3>
<p>Input: - <code>Arr</code> - array to sort - <code>left</code> - starting index - <code>right</code> - ending index</p>
<p>Uses: - <a href="#pseudocode-partition"><code>partition</code></a></p>
<p>Pseudocode:</p>
<pre><code>function QuickSort(Arr, left, right):
  if left &lt; right:
    select a PivotIndex
    pivotNewIndex :=
      partition(Arr, left, right, PivotIndex)

    QuickSort(Arr, left, pivotNewIndex-1)
    QuickSort(Arr, pivotNewIndex+1, right)</code></pre>
<h3 id="pseudocode-partition">Pseudocode <code>partition</code></h3>
<p>Input: - <code>Arr</code> - array to partition - <code>left</code> - starting index - <code>right</code> - ending index</p>
<p>Pseudocode:</p>
<pre><code>function partition(Arr, left, right, PivotIndex):
  pivot = Arr[PivotIndex]

  i := left - 1 // index of smaller element

  for j = left, j &lt;= right - 1, j++:
    if Arr[j] &lt; pivot:
      i++ // increment the index of smaller element
      swap Arr[i] and Arr[j]
  swap Arr[i + 1] and Arr[right]
  return i+1</code></pre>
<h2 id="resolving-the-asymptotic-of-quicksort">Resolving the asymptotic of <code>QuickSort</code></h2>
<p>Assumptions: - <span class="math inline">\(\forall x_i,x_j \in Arr : x_i \neq x_j\)</span> for <span class="math inline">\(i\neq j\)</span> - all permutations of the <span class="math inline">\(Arr\)</span> sequence have the same probability of appearance - <span class="math inline">\(|Arr| = n\)</span></p>
<p><span class="math inline">\(Q_n\)</span> - average number of comparisons used by QuickSort function</p>
<p>Clearly <span class="math inline">\(Q_0 = Q_1 = 0\)</span>.</p>
<p>Let <span class="math inline">\(n \ge 2\)</span>. After selecting an arbitrary pivot element there are <span class="math inline">\(n-1\)</span> comparisons because of the <a href="#pseudocode-partition"><code>partition</code> function</a> invoked by the <a href="#pseudocode-quicksort"><code>QuickSort</code> function</a>. The <code>partition</code> function has divided <code>Arr</code> into two pieces: left and right with the pivot in the middle. Assuming the left part is of length <span class="math inline">\(k\)</span> then the right part is of length <span class="math inline">\(n-1-k\)</span>. Please note that all <span class="math inline">\(k \in \{0,\dots,n-1\}\)</span> are equal probability of appearance.<br />
Which gives us following equation for <span class="math inline">\(Q_n\)</span>: <span class="math display">\[
Q_n = (n-1) + \frac{1}{n} \sum_{k=0}^{n-1}(Q_k + Q_{n-1-k})
\]</span></p>
<p>However <span class="math inline">\(\sum_{k=0}^{n-1}Q_{n-1-k} = \sum_{k=0}^{n-1}Q_k\)</span> thus we can rewrite the above equation in a more clear way: <span class="math display">\[
Q_n = (n-1) + \frac{2}{n}\sum_{k=0}^{n-1}Q_k
\]</span></p>
<p><strong>This is the Quick Sort Equation.</strong><br />
See <a href="https://cs.pwr.edu.pl/cichon/Math/QSortAvg.pdf">this paper by Jacek Cichoń</a> on how to solve this equation.</p>
<p>We get <span class="math display">\[
Q_n = (n+1) (4H_{n+1} - 2H_n -4)
\]</span> where <a href="https://en.wikipedia.org/wiki/Harmonic_number"><span class="math inline">\(H_n\)</span> is the <span class="math inline">\(n\)</span>th harmonic number</a>.</p>
<p>We need to obtain an asymptotic of the terms <span class="math inline">\(Q_n\)</span>. See <a href="https://cs.pwr.edu.pl/cichon/Math/QSortAvg.pdf">this paper by Jacek Cichoń</a> on how to obtain this asymptotic.</p>
<p>We have <span class="math display">\[
Q_n = 2n(\ln n + \gamma -2) + 2\ln n + 2\gamma + 1 + O\Big(\frac{1}{n}\Big)
\]</span> where <span class="math inline">\(\gamma\)</span> is the <a href="https://en.wikipedia.org/wiki/Euler%E2%80%93Mascheroni_constant">Euler-Mascheroni constant</a> Above equation can obviously be written as <span class="math display">\[
T(n) = 2n(\ln n + \gamma -2) + 2\ln n + 2\gamma + 1 + O\Big(\frac{1}{n}\Big)
\]</span> to adhere to the format of previous algorithm analyses we performed.</p>
<p>Above equation describes what is the average time complexity of the <code>QuickSort</code> function.</p>
<p>Sources: - <a href="https://cs.pwr.edu.pl/cichon/Math/QSortAvg.pdf">QuickSort - Average Complexity by Jacek Cichoń</a> - <a href="https://www.geeksforgeeks.org/quick-sort/">QuickSort - GeeksForGeeks</a></p>
</body>
</html>
